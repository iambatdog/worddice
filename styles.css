:root{
  --bg:#fff8ec;
  --card:#fff;
  --accent:#ff6b6b;
  --muted:#6b6b6b;
  --shadow: 0 6px 18px rgba(0,0,0,0.12);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(180deg, var(--bg), #fff);
  color:#333;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}
.container{
  max-width:900px;
  width:100%;
  background:var(--card);
  border-radius:16px;
  box-shadow:var(--shadow);
  padding:28px;
}
.title{
  margin:0 0 6px 0;
  font-size:2.2rem;
  color:var(--accent);
}
.lead{margin:0 0 18px 0;color:var(--muted)}
.controls{display:flex;gap:12px;align-items:center;margin-bottom:18px}
label{font-weight:600}
select{padding:8px;border-radius:8px;border:1px solid #eee;background:#fff}
.btn{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
.btn.ghost{background:transparent;color:var(--accent);border:2px solid var(--accent)}
/* Settings button placed at the right end of controls */
.settings-btn{margin-left:auto;padding:8px 10px;font-size:1rem;border-radius:10px}

/* Gentle cog wobble on hover/focus to draw attention (respects reduced motion) */
@keyframes cog-wobble{0%{transform:rotate(0deg)}25%{transform:rotate(-12deg)}60%{transform:rotate(8deg)}100%{transform:rotate(0deg)}}
.settings-btn svg{transition:transform .36s ease}
@media (prefers-reduced-motion: no-preference){
  .settings-btn:hover svg, .settings-btn:focus svg, .settings-btn:active svg{
    animation: cog-wobble .9s ease-in-out 1;
  }
}
.dice-area{display:grid;gap:14px;padding:14px;border-radius:12px;background:linear-gradient(180deg,#fff,#fffaf0);min-height:160px;align-items:center;justify-content:center;/* lay out in columns so items fill rows; JS will set grid-template-columns */grid-auto-flow:column;grid-template-rows:repeat(2,1fr);grid-auto-columns:minmax(96px,1fr);}
.dice-area.small{grid-auto-columns:minmax(96px,1fr);}
.dice-area.medium{grid-auto-columns:minmax(84px,1fr);}
.dice-area.large{grid-auto-columns:minmax(72px,1fr);}
.die{width:100%;max-width:120px;aspect-ratio:1/1;background:#f9fafb;border-radius:14px;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 20px rgba(0,0,0,0.08);position:relative;overflow:hidden;transition:transform .18s ease, box-shadow .18s ease}
.die:hover{transform:translateY(-4px);box-shadow:0 14px 28px rgba(0,0,0,0.12)}
.die .face{width:86%;height:86%;background:#fff;border-radius:12px;display:flex;align-items:center;justify-content:center;padding:6px}
.die img{width:86%;height:86%;object-fit:contain}

/* Kept dice visual state: user clicked to keep this die */
.die.kept{outline:4px solid rgba(34,124,226,0.18);transform:translateY(-6px);}
.die.kept .face{box-shadow:inset 0 0 0 4px rgba(34,124,226,0.06)}

.btn.reroll{background:#1f8ceb}

/* Make dice keyboard-focusable and show focus outline */
.die{cursor:pointer}
.die:focus{outline:3px solid rgba(34,124,226,0.9);outline-offset:3px}
.die[role="button"]{cursor:pointer}

/* Helper note shown after first roll */
#roll-helper{margin-top:10px;display:block}

/* Screen-reader only utility */
.sr-only{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap;border:0;padding:0;margin:-1px}

/* Responsive rows: default 2 rows; small screens 1 row (stack vertically), wide screens 3 rows */
@media (max-width:520px){
  .dice-area{grid-template-rows:repeat(1,1fr);grid-auto-flow:row;}
  .die{max-width:96px}
}

@media (min-width:1100px){
  .dice-area{grid-template-rows:repeat(3,1fr);} /* switch to 3 rows on wide screens */
}

/* Optional horizontal layout (opt-in). Apply the class `horizontal` to #dice-area to enable */
.dice-area.horizontal{
  grid-auto-flow:row; /* flow left-to-right */
  grid-template-rows:repeat(1,1fr); /* single row when horizontal */
  grid-auto-columns:minmax(96px,1fr);
  align-items:center;
}
.die svg{width:64px;height:64px;filter:drop-shadow(0 6px 6px rgba(0,0,0,0.06))}
.die.spin{animation:spin 700ms ease-in-out}
@keyframes spin{0%{transform:rotateX(0) scale(1)}50%{transform:rotateX(90deg) scale(0.9)}100%{transform:rotateX(0) scale(1)}}
.prompt{margin-top:18px;padding:14px;border-radius:10px;background:#fff9f0}
.prompt h2{margin:0 0 8px 0}
.prompt p{margin:0;font-size:1.05rem}
.footer{margin-top:12px;text-align:center;color:var(--muted)}

.safe-list-panel{margin-top:14px;padding:10px 12px;border-radius:10px;background:#fff;border:1px solid #fdebd0}
.safe-list{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
.safe-list{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px;align-items:center}
.safe-item{display:flex;align-items:center;gap:8px;background:#fff6ee;padding:6px 8px;border-radius:8px;border:1px solid #ffe5cc;flex:0 0 auto}
.safe-item img, .safe-item picture, .safe-item .placeholder{width:64px;height:64px;display:inline-block}
.safe-item picture img{width:100%;height:100%;object-fit:contain}

/* Hover and focus style for better accessibility */
.safe-item:hover, .safe-item:focus-within{
  outline: 3px solid rgba(255,107,107,0.22);
  box-shadow: 0 6px 16px rgba(255,107,107,0.06);
}
.safe-item svg{width:28px;height:28px}
.note{margin-top:8px;color:var(--muted);font-size:0.9rem}

.pin-controls{margin-top:10px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.pin-controls input{padding:8px;border-radius:8px;border:1px solid #eee}
.pin-controls .btn{padding:8px 10px;font-size:0.9rem}
.pin-controls #pin-msg{margin-left:6px}

@media (max-width:520px){
  .die{width:96px;height:96px}
  .die .face{width:72px;height:72px}
}

/* Modal styles for settings */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:1200}
.modal[hidden]{display:none !important}
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,0.35);backdrop-filter:blur(2px)}
.modal-panel{position:relative;background:var(--card);border-radius:12px;box-shadow:0 18px 40px rgba(0,0,0,0.22);width:min(720px,94%);max-height:86vh;overflow:auto;padding:12px;z-index:1201}
.modal-backdrop{z-index:1200}
/* Ensure the teacher icon sits above the backdrop and is clickable */
#teacher-icon{position:relative;z-index:1202}
.modal-header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:6px 8px}
.modal-header #teacher-icon{margin-right:8px}
.standards-table{width:100%;border-collapse:collapse;margin-top:8px}
.standards-table th,.standards-table td{border:1px solid #f4e6dd;padding:8px;text-align:left}
.standards-table tr{cursor:pointer}
.standards-table tr:hover{background:#fff3f0}
.standards-detail{background:#fff9f0;padding:10px;border-radius:8px;border:1px solid #fdebd0;margin-top:8px}
.modal-body{padding:8px}
.modal-section{margin-bottom:12px}
.modal hr{border:none;border-top:1px solid #f4e6dd;margin:12px 0}

/* Reuse safe-list styles for modal; ensure space for checkboxes */
#safe-list-modal{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
#safe-list-modal .safe-item{width:auto}

@media (max-width:520px){
  .modal-panel{width:94%;padding:8px}
}

/* Hide in-page controls that are managed via the settings modal to avoid duplication */

/* Floating Content Standards button */
.floating-standards{position:fixed;right:20px;bottom:24px;z-index:1300;padding:10px 14px;border-radius:999px;box-shadow:0 8px 20px rgba(0,0,0,0.12)}
.floating-standards.btn{background:#fff;color:var(--accent);border:2px solid var(--accent)}



/* Focus-visible rules for keyboard users */
:focus{outline-offset:3px}
button:focus, .btn:focus, input:focus, select:focus, textarea:focus {
  outline: 3px solid rgba(34,124,226,0.9);
  outline-offset: 3px;
}

/* Prefer :focus-visible when available to avoid showing outlines for mouse clicks */
@supports selector(:focus-visible){
  button:focus, .btn:focus, input:focus, select:focus, textarea:focus { outline: none; }
  button:focus-visible, .btn:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible {
    outline: 3px solid rgba(34,124,226,0.9);
    outline-offset: 3px;
  }
}
